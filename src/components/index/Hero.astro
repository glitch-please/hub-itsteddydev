---
import { getI18N } from "@/i18n";
import IconChevronDown from "../../icons/IconChevronDown.astro";
import IconMoon from "../../icons/IconMoon.astro";
import IconShare2 from "../../icons/IconShare2.astro";
import IconSun from "../../icons/IconSun.astro";
import HeroButton from "../HeroButton.astro";
import LanguagePicker from "../LanguagePicker.astro";
import Tooltip from "../Tooltip.astro";

//Para cambiar idioma de textos
const { currentLocale } = Astro;
const i18n = getI18N({ currentLocale });
---

<div>
  <div class="flex justify-between">
    <a href="/">
      <!--?xml version="1.0" encoding="UTF-8"?-->
      <svg
        id="Layer_1"
        xmlns="http://www.w3.org/2000/svg"
        width="100"
        version="1.1"
        viewBox="0 0 400 143.7"
      >
        <defs>
          <style>
            .fill {
              fill: black;
            }

            .dark .fill {
              fill: white;
            }
          </style>
        </defs>
        <g>
          <path class="fill" d="M60.7,135.7c-.7-.9-1.2-2.2-2.7-2"></path>
          <path
            class="fill"
            d="M38.3,133.2c-7.6-16.2-6.7-28.6-.5-44.8,4-10.2,18.3-31.4,15.9-41.8-1.3-5.7-2.5-11.9-4.1-17.4s-3.4-3-.9-3.6c10.2,12.1,18.8,22,18.4,38.9-.2,8.8-6.2,19.5,0,27,6.1,7.5,12.8,1,17.5-4.5l3.4-10.1c9.3,17.7,9.3,40.6-3.6,56.4"
          ></path>
          <path
            class="fill"
            d="M22.4,124.8c-1.4.6-1.8-1.4-2.4-2.4-24.6-36.8,20.1-62.5,12.1-98.8s-4.8-10-6.4-15.2c6.9,6,11.2,14.4,12.6,23.5,3.8,24.4-20.9,45.2-21,69.2s2.1,15.6,5.1,23.7Z"
          ></path>
          <path
            class="fill"
            d="M46.3,47.4c1.6,14-9.3,28.5-13.8,41.3-5.3,15.2-7.6,29.8,1.6,44.2-18.4-15.9-12.7-38.6-3.9-57.9,3.8-8.5,10.8-17.2,12.1-26.6.6-4.2-.2-8.3-.3-12.4,0-1.2-.8-3.3.8-3.4.7,4.8,3,10.1,3.5,14.8Z"
          ></path>
          <path
            class="fill"
            d="M72.6,90.3c-8.6-4.5-3-15.6-2.5-22.9v-15.3c6.7,12.5.7,25.3,2.5,38.3Z"
          ></path>
        </g>
        <g>
          <path
            class="fill"
            d="M158.4,134.4c-7.6,0-14.7-1.3-21.3-4s-12.2-6.4-17.1-11.3c-4.9-4.8-8.7-10.5-11.4-16.9-2.7-6.4-4.1-13.4-4.1-20.8s1.4-14.4,4.1-20.8c2.7-6.4,6.5-12,11.4-16.8,4.9-4.7,10.6-8.4,17.1-11.1,6.5-2.7,13.6-4,21.3-4s15.4,1.3,21.7,3.9c6.3,2.6,11.9,6.2,16.6,10.7l-15.4,15.5c-2.6-2.9-5.8-5.2-9.7-6.8-3.8-1.6-8.3-2.5-13.3-2.5s-8.5.8-12.2,2.3c-3.7,1.5-6.9,3.7-9.6,6.5-2.7,2.8-4.8,6.2-6.2,10.2-1.5,4-2.2,8.3-2.2,12.9s.7,9.2,2.2,13.1c1.5,3.9,3.5,7.3,6.2,10.2,2.7,2.9,5.9,5,9.6,6.5,3.7,1.5,7.7,2.3,12.2,2.3s9.8-.8,13.7-2.4c3.9-1.6,7.2-3.9,9.9-6.9l15.5,15.5c-4.8,4.6-10.5,8.3-16.8,10.8s-13.8,3.8-22.2,3.8Z"
          ></path>
          <path
            class="fill"
            d="M276.9,132.8h24.3l-40.2-102.5h-20.8l-40.5,102.5h23.7l6.8-18.4h40.1l6.7,18.4ZM237,95.7l13.4-36.4,13.1,36.4h-26.6Z"
          ></path>
          <path
            class="fill"
            d="M385.1,45.4c-3-4.9-7.2-8.6-12.5-11.3-5.3-2.6-11.2-3.9-17.6-3.9h-43v102.5h22.9v-37.3h20c6.5,0,12.4-1.3,17.6-3.9,5.3-2.6,9.4-6.4,12.5-11.3,3-4.9,4.6-10.7,4.6-17.4s-1.5-12.6-4.6-17.5ZM364.7,70.9c-1.4,2.2-3.2,3.9-5.4,5-2.3,1.1-4.8,1.7-7.6,1.7h-16.7v-29.5h16.7c2.8,0,5.3.6,7.6,1.7,2.3,1.1,4.1,2.8,5.4,5,1.4,2.2,2,4.9,2,8.1s-.7,5.8-2,8Z"
          ></path>
        </g>
      </svg>
    </a>
    <div class="flex flex-wrap gap-2">
      <!-- <HeroButton class="size-8">
    <IconShare2 class="size-5" />
  </HeroButton> -->

      <HeroButton aria-label="btn-theme" id="toggle-theme" class="size-8">
        <IconSun class="size-5 dark:hidden" />
        <IconMoon class="hidden size-5 dark:inline" />
      </HeroButton>

      <div class="">
        <LanguagePicker />
      </div>

      <Tooltip tooltip="Logout">
        <HeroButton
          aria-label="btn-logout"
          id="logout-btn"
          class="hidden size-8"
        >
          <i class="bx bx-log-out bx-sm"></i>
        </HeroButton>
      </Tooltip>
    </div>
  </div>
</div>

<script type="module">
  import { createClient } from "https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2/+esm";

  document.addEventListener("DOMContentLoaded", () => {
    const supabaseUrl = "https://qudlxlryegnainztkrtk.supabase.co";
    const supabaseAnonKey =
      "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InF1ZGx4bHJ5ZWduYWluenRrcnRrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI2MzUwMTMsImV4cCI6MjA2ODIxMTAxM30.pAWMWGUCK48Lujssi3Ip4GUm11TZDmaNCINqX3q2m5o";

    const supabase = createClient(supabaseUrl, supabaseAnonKey);
    const logoutBtn = document.getElementById("logout-btn");

    // Check initial auth state
    supabase.auth.getSession().then(({ data: { session } }) => {
      if (session) {
        logoutBtn.classList.remove("hidden");
      }
    });

    // Listen for auth changes
    supabase.auth.onAuthStateChange((event, session) => {
      if (event === "SIGNED_IN" && session) {
        logoutBtn.classList.remove("hidden");
      } else if (event === "SIGNED_OUT") {
        logoutBtn.classList.add("hidden");
      }
    });

    // Add logout functionality
    logoutBtn.addEventListener("click", async () => {
      await supabase.auth.signOut();
    });
  });
</script>
